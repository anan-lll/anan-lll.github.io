import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.a4f2a176.js";const C=JSON.parse('{"title":"Kubernetes","description":"k8s日常使用","frontmatter":{"title":"Kubernetes","date":"2021-06-15T00:00:00.000Z","description":"k8s日常使用","disabled":false,"readMins":10,"tags":["Github"]},"headers":[],"relativePath":"blog/ tools/k8s.md","filePath":"blog/ tools/k8s.md"}'),p={name:"blog/ tools/k8s.md"},o=l(`<h1 id="k8s日常使用" tabindex="-1">k8s日常使用 <a class="header-anchor" href="#k8s日常使用" aria-label="Permalink to &quot;k8s日常使用&quot;">​</a></h1><h2 id="k8s命令列表" tabindex="-1">k8s命令列表 <a class="header-anchor" href="#k8s命令列表" aria-label="Permalink to &quot;k8s命令列表&quot;">​</a></h2><ul><li><a href="http://docs.kubernetes.org.cn/664.html" target="_blank" rel="noreferrer">k8s命令列表</a></li></ul><h2 id="其他常用命令" tabindex="-1">其他常用命令 <a class="header-anchor" href="#其他常用命令" aria-label="Permalink to &quot;其他常用命令&quot;">​</a></h2><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">### 临时修改配置文件：</span></span>
<span class="line"><span style="color:#B392F0;">1.kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span></span>
<span class="line"><span style="color:#B392F0;">2.kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">edit</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">guandata-web-deployment</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 重启pod：</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">po</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">guandata-server-controller-59c67f9df9-htjbv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 查看日志：</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--tail</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">100</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">spark-job-engine-controller-bb5c979bc-qpml5</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">etcd-kmaster1</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kube-system</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--tail</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">200</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kube-apiserver</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-n</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">kube-system</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">#查看最后200行的日志</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-l</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">app=frontend</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;"># 返回所有标记为 app=frontend 的 pod 的合并日志。</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">logs</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--since=1h</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">nginx#查看名称为nginx这个pod最近一小时的日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 查看多节点的机器：</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pods</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-o</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">wide</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">关键词</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 强制删除pod：</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">pod</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">guandata-server-deployment-7985b6dd56-h5dht</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--force</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 缩容：</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">scale</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--replicas=x</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span><span style="color:#E1E4E8;">  [your </span><span style="color:#9ECBFF;">deployment]</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">scale</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--replicas=0</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">deployment</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">spark-job-engine-etl-controller</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 部署多节点：</span></span>
<span class="line"><span style="color:#B392F0;">把Deployment改成DaemonSet,把replicas那一行删掉</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 删除pod:</span></span>
<span class="line"><span style="color:#B392F0;">可以直接删除yaml文件，例如</span></span>
<span class="line"><span style="color:#B392F0;">kubectl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">delete</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-f</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server-controller.yaml</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">### 临时修改配置文件：</span></span>
<span class="line"><span style="color:#6F42C1;">1.kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span></span>
<span class="line"><span style="color:#6F42C1;">2.kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">edit</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span><span style="color:#24292E;"> </span><span style="color:#032F62;">guandata-web-deployment</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 重启pod：</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">po</span><span style="color:#24292E;"> </span><span style="color:#032F62;">guandata-server-controller-59c67f9df9-htjbv</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 查看日志：</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--tail</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">100</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">spark-job-engine-controller-bb5c979bc-qpml5</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;">  </span><span style="color:#032F62;">etcd-kmaster1</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kube-system</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--tail</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">200</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kube-apiserver</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-n</span><span style="color:#24292E;"> </span><span style="color:#032F62;">kube-system</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">#查看最后200行的日志</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-l</span><span style="color:#24292E;"> </span><span style="color:#032F62;">app=frontend</span><span style="color:#24292E;"> </span><span style="color:#6A737D;"># 返回所有标记为 app=frontend 的 pod 的合并日志。</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">logs</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--since=1h</span><span style="color:#24292E;"> </span><span style="color:#032F62;">nginx#查看名称为nginx这个pod最近一小时的日志</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 查看多节点的机器：</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pods</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-o</span><span style="color:#24292E;"> </span><span style="color:#032F62;">wide</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">关键词</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 强制删除pod：</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#032F62;">pod</span><span style="color:#24292E;"> </span><span style="color:#032F62;">guandata-server-deployment-7985b6dd56-h5dht</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--force</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 缩容：</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">scale</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--replicas=x</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span><span style="color:#24292E;">  [your </span><span style="color:#032F62;">deployment]</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">scale</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--replicas=0</span><span style="color:#24292E;"> </span><span style="color:#032F62;">deployment</span><span style="color:#24292E;">  </span><span style="color:#032F62;">spark-job-engine-etl-controller</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 部署多节点：</span></span>
<span class="line"><span style="color:#6F42C1;">把Deployment改成DaemonSet,把replicas那一行删掉</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">### 删除pod:</span></span>
<span class="line"><span style="color:#6F42C1;">可以直接删除yaml文件，例如</span></span>
<span class="line"><span style="color:#6F42C1;">kubectl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">delete</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-f</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server-controller.yaml</span></span></code></pre></div>`,5),e=[o];function t(c,r,y,E,F,i){return n(),a("div",null,e)}const B=s(p,[["render",t]]);export{C as __pageData,B as default};
